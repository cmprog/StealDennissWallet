<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Hide & Seek Game</title>
<style>
  body { margin:0; background:#222; display:flex; justify-content:center; align-items:center; height:100vh;}
  canvas { background:#111; display:block; }
</style>
</head>
<body>
<canvas id="game" width="900" height="600"></canvas>
<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const imgPlayer1 = new Image(); imgPlayer1.src = "player1.png";
const imgPlayer2 = new Image(); imgPlayer2.src = "player2.png";
const imgDennis  = new Image(); imgDennis.src  = "dennis.png";
const imgWallet  = new Image(); imgWallet.src  = "wallet.png";

// --- OBJECTS ---
const player1 = { x: 50, y: 50, w: 32, h:32, speed: 2, startX:50, startY:50 };
const player2 = { x:100, y: 50, w: 32, h:32, speed: 2, startX:100,startY:50 };

const dennis  = { x:700, y:500, w: 40, h:40, dx:1.5, dy:-1.2, speed:1.5 };
const wallet  = { x:750, y:520, w: 24, h:24 };

const walls = [
  {x:200, y:100, w:20, h:400},
  {x:400, y:0,   w:20, h:300},
  {x:600, y:200, w:20, h:400},
  {x:0,   y:300, w:300,h:20 },
  {x:400, y:400, w:300,h:20 }
];

let gameOver = false;

// key state
const keys = {};
document.addEventListener('keydown',e=>keys[e.key]=true);
document.addEventListener('keyup',e=>keys[e.key]=false);

// movement + collision helpers
function move(obj, dx, dy) {
  let newX = obj.x + dx;
  let newY = obj.y + dy;

  if(newX < 0) newX = 0;
  if(newY < 0) newY = 0;
  if(newX + obj.w > canvas.width)  newX = canvas.width - obj.w;
  if(newY + obj.h > canvas.height) newY = canvas.height - obj.h;

  let temp = {x:newX, y:newY, w:obj.w, h:obj.h};
  for(let w of walls){
    if(rectIntersect(temp,w)) return;
  }
  obj.x = newX;
  obj.y = newY;
}

function rectIntersect(a,b){
  return !(a.x+a.w < b.x || a.x > b.x+b.w || a.y+a.h < b.y || a.y > b.y+b.h);
}

// Dennis simple AI movement
function moveDennis(){
  let newX = dennis.x + dennis.dx;
  let newY = dennis.y + dennis.dy;

  // bounce off screen edges
  if(newX < 0 || newX + dennis.w > canvas.width) dennis.dx *= -1;
  if(newY < 0 || newY + dennis.h > canvas.height) dennis.dy *= -1;

  // bounce off walls
  let temp = {x:newX, y:newY, w:dennis.w, h:dennis.h};
  for(let w of walls){
    if(rectIntersect(temp,w)){
      dennis.dx *= -1;
      dennis.dy *= -1;
      return;
    }
  }

  dennis.x += dennis.dx;
  dennis.y += dennis.dy;

  // occasionally change direction
  if(Math.random() < 0.01){
    dennis.dx = (Math.random()*2-1)*dennis.speed;
    dennis.dy = (Math.random()*2-1)*dennis.speed;
  }
}

// Fog LOS
const FOG_RADIUS = 120;

function update(){
  if(gameOver) return;

  // movement
  if(keys["ArrowUp"])    move(player1,0,-player1.speed);
  if(keys["ArrowDown"])  move(player1,0, player1.speed);
  if(keys["ArrowLeft"])  move(player1,-player1.speed,0);
  if(keys["ArrowRight"]) move(player1, player1.speed,0);

  if(keys["w"]) move(player2,0,-player2.speed);
  if(keys["s"]) move(player2,0, player2.speed);
  if(keys["a"]) move(player2,-player2.speed,0);
  if(keys["d"]) move(player2, player2.speed,0);

  moveDennis();

  // collision with wallet (win)
  if(rectIntersect(player1,wallet) || rectIntersect(player2,wallet)){
    gameOver = true;
  }

  // Dennis punishment
  [player1, player2].forEach(p=>{
    if(rectIntersect(p, dennis)){
      p.x = p.startX;
      p.y = p.startY;
    }
  });
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // walls
  ctx.fillStyle = "gray";
  walls.forEach(w=>ctx.fillRect(w.x,w.y,w.w,w.h));

  // wallet
  ctx.drawImage(imgWallet, wallet.x, wallet.y, wallet.w, wallet.h);

  // dennis
  ctx.drawImage(imgDennis, dennis.x, dennis.y, dennis.w, dennis.h);


  // players
  ctx.drawImage(imgPlayer1, player1.x, player1.y, player1.w, player1.h);
  ctx.drawImage(imgPlayer2, player2.x, player2.y, player2.w, player2.h);

  // Fog of war
  const fog = document.createElement("canvas");
  fog.width = canvas.width;
  fog.height = canvas.height;
  const fctx = fog.getContext("2d");
  fctx.fillStyle = "black";
  fctx.fillRect(0,0,fog.width,fog.height);

  fctx.globalCompositeOperation = "destination-out";
  [player1, player2].forEach(p=>{
    let grad = fctx.createRadialGradient(
      p.x+p.w/2,p.y+p.h/2,0,
      p.x+p.w/2,p.y+p.h/2,FOG_RADIUS
    );
    grad.addColorStop(0,"rgba(0,0,0,1)");
    grad.addColorStop(1,"rgba(0,0,0,0)");
    fctx.fillStyle = grad;
    fctx.beginPath();
    fctx.arc(p.x+p.w/2,p.y+p.h/2,FOG_RADIUS,0,Math.PI*2);
    fctx.fill();
  });
  ctx.drawImage(fog,0,0);

  // win screen
  if(gameOver){
    ctx.fillStyle="white";
    ctx.font="40px sans-serif";
    ctx.fillText("YOU WIN!", canvas.width/2-100, canvas.height/2);
  }
}

function gameLoop(){
  update();
  draw();
  requestAnimationFrame(gameLoop);
}
gameLoop();
</script>

</body>
</html>
